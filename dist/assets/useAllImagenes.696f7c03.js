import{b as o,d as T,j as n,T as h,F as g,G as A,c as C,f as F,A as _,B as k,g as B,h as U,I as W,r as I,u as E,i as R,a as j}from"./index.b32bce0f.js";import{S as G}from"./chakra-ui-spinner.esm.cdc97e94.js";let P=(r=21)=>crypto.getRandomValues(new Uint8Array(r)).reduce((s,a)=>(a&=63,a<36?s+=a.toString(36):a<62?s+=(a-26).toString(36).toUpperCase():a>62?s+="-":s+="_",s),"");const L=({inputId:r})=>o(T,{p:8,w:"full",h:"full",borderWidth:1,borderStyle:"dashed",borderColor:"gray.300",children:n(h,{fontSize:{base:18,md:28},textAlign:"center",children:["Arratra tus archivos o"," ",o(h,{htmlFor:`input-file-${r}`,as:"label",color:"blue.600",_hover:{textDecoration:"underline",cursor:"pointer"},children:"selecciona tus archivos"})]})}),M=r=>parseFloat(String(Math.floor(r/1e3))),O=({files:r,inputId:s,onDelete:a,onCancel:f,onUpload:d})=>n(g,{flexDir:"column",h:"full",children:[n(A,{pb:2,gap:3,alignItems:"center",borderBottomWidth:1,borderBottomColor:"gray.200",_dark:{borderBottomColor:"gray.700"},templateColumns:{base:"repeat(1, minmax(0, 1fr))",md:"repeat(3, minmax(0, 1fr))"},children:[o(C,{onClick:f,variant:"ghost",colorScheme:"primary",w:{base:"full",md:"max"},children:"Cancelar"}),n(h,{textAlign:"center",fontWeight:"medium",display:{base:"none",md:"block"},children:[r==null?void 0:r.length," archivos seleccionados"]}),o(C,{ml:"auto",w:{base:"full",md:"max"},as:"label",variant:"outline",colorScheme:"primary",leftIcon:o(F,{as:_}),htmlFor:`input-file-${s}`,children:"A\xF1adir mas"})]}),o(A,{py:2,gap:2,flex:1,overflowY:"auto",autoRows:{base:"64px",md:"188px"},templateColumns:{base:"minmax(0, 1fr)",md:"repeat(auto-fit, minmax(185px, 300px))"},children:r&&r.map(({id:p,file:c,blob:u})=>n(g,{gap:{base:3,md:0},w:"full",h:"full",flexDir:{base:"row",md:"column"},children:[n(k,{pos:"relative",rounded:"base",overflow:"hidden",w:{base:"20",md:"full"},h:{base:"16",md:"145px"},mb:2,children:[o(B,{top:0,right:0,zIndex:20,size:"xs",pos:"absolute",bg:"black",color:"gray.300","aria-label":"Eliminar archivo",_hover:{bg:"blackAlpha.500"},_dark:{bg:"white",color:"gray.700"},icon:o(U,{}),onClick:()=>a(p),display:{base:"none",md:"block"}}),o(W,{w:"full",h:"full",inset:0,zIndex:10,pos:"absolute",alt:c.name,src:URL.createObjectURL(u)})]}),n(k,{children:[o(h,{fontSize:"12px",fontWeight:"medium",children:c.name}),n(h,{fontSize:"11px",color:"#757575",children:[M(c.size)," KB"]}),o(C,{size:"xs",variant:"ghost",colorScheme:"red",onClick:()=>a(p),display:{md:"none"},children:"Eliminar"})]})]},p))}),o(g,{pt:2,borderTopWidth:1,borderTopColor:"gray.200",_dark:{borderTopColor:"gray.700"},children:n(C,{onClick:d,colorScheme:"primary",w:{base:"full",md:"max"},children:["Subir ",r==null?void 0:r.length," ",(r==null?void 0:r.length)===1?"archivo":"archivos"," "]})})]}),$=r=>o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 512",...r,children:o("path",{fill:"currentColor",d:"M144 480C64.47 480 0 415.5 0 336c0-62.8 40.17-116.2 96.2-135.9-.13-2.7-.2-5.4-.2-8.1 0-88.4 71.6-160 160-160 59.3 0 111 32.25 138.7 80.2C409.9 101.1 428.3 96 448 96c53 0 96 42.1 96 96 0 12.2-2.3 23.8-6.4 34.6C596 238.4 640 290.1 640 352c0 70.7-57.3 128-128 128H144zm79-217c-9.3 9.4-9.3 24.6 0 33.1 9.4 10.2 24.6 10.2 33.1 0l39.9-38.2V392c0 13.3 10.7 24 24 24s24-10.7 24-24V257.9l39 38.2c9.4 10.2 24.6 10.2 33.1 0 10.2-8.5 10.2-23.7 0-33.1l-80-80c-8.5-9.3-23.7-9.3-33.1 0l-80 80z"})}),V=({isDragging:r})=>o(T,{inset:0,w:"full",h:"full",pos:"absolute",transition:"opacity 250ms ease-out",opacity:r?"1":"0",pointerEvents:r?"auto":"none",bg:"rgba(250, 250, 250, 0.95)",_dark:{bg:"rgba(0, 0, 0, 0.95)"},zIndex:30,children:n(g,{justify:"center",align:"center",flexDir:"column",children:[o(F,{as:$,fontSize:48,color:"primary.500"}),o(h,{color:"gray.600",_dark:{color:"gray.400"},fontWeight:"semibold",children:"Deja caer tus archivos aqui"})]})}),K=({onUpload:r,isLoading:s})=>{const a=I.exports.useId(),f=E(),d=I.exports.useRef(0),[p,c]=I.exports.useState(!1),[u,b]=I.exports.useState([]),m=()=>{b([])},z=async()=>{if(typeof r=="function"){const e=u.map(({file:l})=>l);if(!await r(e))return;m()}},y=e=>{b(t=>t.filter(({id:l})=>l!==e))},x=e=>{if(!e)return;let t=!1;const l=[];for(const i of[...e]){if(!i.type.includes("image")){console.log("Solo puede subir imagenes, type: ",i.type),t=!0;continue}l.push({file:i,id:P(),blob:new Blob([i],{type:i.type})})}b(i=>[...i,...l]),t&&f({status:"warning",title:"Solo se deben seleccionar imagenes",description:"Se han omitido los archivos que no son imagenes."})},v=e=>{var t,l,i;e.preventDefault(),e.stopPropagation(),c(!1),((t=e==null?void 0:e.dataTransfer)==null?void 0:t.files)&&((l=e==null?void 0:e.dataTransfer)==null?void 0:l.files.length)>0&&(x((i=e==null?void 0:e.dataTransfer)==null?void 0:i.files),e==null||e.dataTransfer.clearData(),d.current=0)},w=e=>{e.preventDefault(),e.stopPropagation()},D=e=>{var t,l;e.preventDefault(),e.stopPropagation(),d.current+=1,((t=e==null?void 0:e.dataTransfer)==null?void 0:t.items)&&((l=e==null?void 0:e.dataTransfer)==null?void 0:l.items.length)>0&&c(!0)},S=e=>{e.preventDefault(),e.stopPropagation(),d.current-=1,!(d.current>0)&&c(!1)};return n(g,{flex:1,maxW:"1980px",mx:"auto",w:"full",children:[o("input",{hidden:!0,multiple:!0,type:"file",id:`input-file-${a}`,onChange:e=>{const t=e.target.files;console.log({_files:t}),x(t)}}),n(k,{as:"div",p:2,w:"full",flex:1,bg:"gray.50",rounded:"base",pos:"relative",borderWidth:1,borderColor:"gray.300",_dark:{bg:"gray.900",borderColor:"gray.700"},onDrop:v,onDragOver:w,onDragLeave:S,onDragEnter:D,children:[s&&o(T,{pos:"absolute",inset:0,w:"full",h:"full",bg:"rgba(250, 250, 250, 0.95)",_dark:{bg:"rgba(0, 0, 0, 0.95)"},zIndex:40,children:n(g,{align:"center",flexDir:"column",gap:3,children:[o(G,{size:"xl",color:"primary.500"}),o(h,{fontWeight:"medium",children:"Subiendo archivos por favor espere..."})]})}),o(V,{isDragging:p}),u.length===0&&o(L,{inputId:a}),u.length!==0&&o(O,{inputId:a,files:u,onCancel:m,onDelete:y,onUpload:z})]})]})},N=({pagina:r,numeroPagina:s})=>{var y,x,v,w;const{data:a,loading:f,refetch:d}=R({fetchPolicy:"network-only",variables:{pagina:r,numeroPagina:s}}),p=(x=(y=a==null?void 0:a.GetAllImagenes)==null?void 0:y.data)!=null?x:[],c=(w=(v=a==null?void 0:a.GetAllImagenes)==null?void 0:v.numeroTotal)!=null?w:0,u=a==null?void 0:a.GetAllImagenes,[b]=j();let m;return{db:p,loading:f,refetch:d,handleUpload:async D=>{m=!1;for(const S of D)try{await b({variables:{imagen:S}})}catch(e){m=!0,console.log("Error al subir imagenes: ",e)}},hasError:m,nTotal:c,datos:u}};export{K as U,N as u};
