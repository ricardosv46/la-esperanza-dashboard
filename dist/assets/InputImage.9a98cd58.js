import{u as W,a as V,a8 as _,r as c,j as a,R as w,b as e,a9 as G,aa as A,ab as q,ac as F,ad as z,T as v,ae as D,c as i,af as P,ag as $,F as b,H as J,ah as K,G as N,e as Q,d as C,ai as X,I as H,aj as Y,f as Z,A as ee}from"./index.b32bce0f.js";import{u as re,U as ne}from"./useAllImagenes.696f7c03.js";import{S as U}from"./chakra-ui-spinner.esm.cdc97e94.js";const ae=({isOpen:x,onClose:d,onSelect:f})=>{const t=W(),[y]=V(),[S,{loading:I}]=_(),{db:n,refetch:p}=re({pagina:1,numeroPagina:90});console.log(n);const u=c.exports.useRef(null),[m,s]=c.exports.useState(!1),[L,g]=c.exports.useState(!1),[k,E]=c.exports.useState(!1),[o,M]=c.exports.useState(null),O=async r=>{let l=!1;s(!0);for(const h of r)try{await y({variables:{imagen:h}})}catch(T){l=!0,console.log("Error al subir imagenes: ",T)}return l?(s(!1),t({status:"error",title:"Error en la subida de imagenes",description:"Ha ocurrido un error en la subida de imagenes."}),!1):(p(),t({status:"success",title:"Subida de imagenes exitosa",description:"Todas las imagenes se han subido con exito"}),s(!1),!0)},R=async()=>{let r=!1;try{await S({variables:{id:+(o==null?void 0:o.id)}})}catch(l){r=!0,console.log("Error al subir imagenes: ",l)}if(r)return t({status:"error",title:"Error al eliminar la imagen",description:"Ha ocurrido un error al eliminar de imagenes."}),!1;p(),t({status:"success",title:"La imagen ha sido eliminada"}),g(!1)},j=()=>{d(),s(!1),M(null),E(!1)},B=()=>{typeof f=="function"&&f(o),j()};return a(w,{children:[e(G,{isCentered:!0,isOpen:L,leastDestructiveRef:u,onClose:()=>g(!1),children:e(A,{children:a(q,{children:[e(F,{fontSize:"lg",fontWeight:"bold",children:"Eliminar Imagen"}),a(z,{children:[e(v,{children:"Estas seguro que deseas eliminar la imagen"}),a(v,{children:[o==null?void 0:o.titulo," ?"]})]}),a(D,{children:[e(i,{ref:u,onClick:()=>g(!1),children:"Cancelar"}),e(i,{colorScheme:"red",onClick:R,ml:3,children:"Eliminar"})]})]})})}),a(P,{isOpen:x,onClose:j,scrollBehavior:"inside",children:[e(A,{}),a($,{w:"full",maxW:"90vw",minH:"90vh",bg:"gray.800",children:[e(F,{children:a(b,{justify:"space-between",align:"center",mt:10,children:[e(J,{children:"Imagenes"}),e(i,{variant:"outline",colorScheme:"primary",onClick:()=>E(r=>!r),children:k?"Ver galeria":"Subir Imagen"})]})}),e(K,{}),a(z,{display:"flex",children:[!k&&e(N,{w:"full",gap:8,autoRows:"200px",templateColumns:"repeat(auto-fit, minmax(200px, 1fr))",children:n&&(n==null?void 0:n.map(r=>{const l=(o==null?void 0:o.id)===r.id;return a(Q.button,{rounded:"lg",pos:"relative",borderWidth:1,cursor:"pointer",borderColor:l?"primary.500":"gray.300",_dark:{borderColor:l?"primary.500":"gray.700"},overflow:"hidden",_hover:{shadow:"md"},transition:"box-shadow 250ms linear",onClick:()=>{M(h=>(h==null?void 0:h.id)===r.id?null:r)},children:[l&&e(C,{w:5,h:5,top:0,right:0,pos:"absolute",color:"black",bg:"primary.500",zIndex:20,children:e(X,{fontSize:"12px"})}),e(H,{src:r==null?void 0:r.url,alt:r==null?void 0:r.titulo,fallback:e(C,{children:e(U,{colorScheme:"primary",size:"lg"})}),w:"full",h:"full",pos:"absolute",inset:0,objectFit:"contain",zIndex:10})]},r==null?void 0:r.id)}))}),k&&e(ne,{isLoading:m,onUpload:O})]}),e(D,{children:a(b,{children:[e(i,{variant:"ghost",colorScheme:"red",mr:3,onClick:d,children:"Cerrar"}),e(i,{mr:3,variant:"outline",colorScheme:"red",isLoading:I,onClick:()=>g(!0),disabled:o===null,children:"Eliminar"}),e(i,{mr:3,colorScheme:"primary",onClick:B,disabled:o===null,children:"Seleccionar"})]})})]})]})]})},te=({label:x,...d})=>{var m,s;const{isOpen:f,onClose:t,onOpen:y}=Y(),[S,I]=c.exports.useState(null),n=(m=d.value)!=null?m:S,p=(s=d.onChange)!=null?s:I,u=!!(n!=null&&n.id);return a(w,{children:[e(ae,{isOpen:f,onClose:t,onSelect:p}),e(b,{justifyContent:"center",onClick:y,children:a(b,{w:96,h:48,pos:"relative",flexDirection:"column",border:"2px",borderStyle:"dashed",borderColor:"slategrey",rounded:"lg",justifyContent:"center",alignItems:"center",cursor:"pointer",children:[!u&&a(w,{children:[e(C,{rounded:"full",w:50,h:50,bg:"primary.500",_dark:{bg:"#F0AC42"},children:e(Z,{as:ee,color:"black"})}),e(v,{color:"slategray",fontWeight:"semibold",pt:2,children:x})]}),u&&e(H,{src:n==null?void 0:n.url,alt:n==null?void 0:n.titulo,fallback:e(C,{children:e(U,{colorScheme:"primary",size:"lg"})}),w:"full",h:"full",pos:"absolute",inset:0,objectFit:"contain",zIndex:10})]})})]})};export{te as I};
